---
category: blog
layout: post
date: 2020-02-19T09:00:00+09:00
tags: [ "markdown", "mathjax" ]
---

# MathJax と Markdown で可搬性のある数式を書くには

数式を含む web ページを書くとき、MathJax の記法と Markdown の記法が衝突して困った経験はありませんか？
${} _ n C _ r$ と書こうとして <span>$</span>{} <i>nC</i> r<span>$</span> のように表示されたり、$\min \lbrace x \mid \varphi(x) \rbrace$ と書いたはずが $\min x \mid \varphi(x)$ と表示されたりした経験がある人は多いはずです。
そして、なんとか調整を頑張ってあるひとつの Markdown 処理系の上では適切に表示される状態にしたのに、別の Markdown 処理系に持っていったら壊れてしまったということはありませんか？
そのような面倒を回避するためのテクを紹介します。

## 下付き文字 `x_i`

下付き文字を書くときは `_` の前後に空白を入れてください[^underscore]。
Markdown における強調の記法 `_foo_` と衝突するためです。
たとえば $a _ i$ と表示するには `$x_i$` や `$x\_i$` ではなく `$x _ i$` と書いてください。

## 縦線 `|`

縦線を書くときは `\mid` や `\vert` を使ってください。
Markdown における表の記法 `| a | b | c |` と衝突するためです。
たとえば $\vert \vec{a} \vert$ と表示するには `$|\vec{a}|$` や `$\|\vec{a}\|$` ではなく `$\vert \vec{a} \vert$` と書いてください。

## 不等号 `<` `>`

不等号を書くときは `\lt` や `\gt` を使ってください。
HTML におけるタグの記法 `<a>` と衝突するためです。
たとえば $a \lt b$ と表示するには `$a < b$` ではなく `$a \lt b$` と書いてください。

## 波括弧 `\{` `\}`

波括弧を書くときは `\lbrace` `\rbrace` を使ってください。
Markdown におけるエスケープの記法 `\` の仕様の曖昧さのためです。
たとえば $\lbrace 0, 1, 2, \dots \rbrace$ と表示するには `$\{ 0, 1, 2, \dots \}$` や `$\\{ 0, 1, 2, \dots \\}$` ではなく `$\lbrace 0, 1, 2, \dots \rbrace$` と書いてください。

## 角括弧 `\[` `\]`

角括弧を書くときは `\lbrack` `\rbrack` を使ってください。
Markdown におけるエスケープの記法 `\` の仕様の曖昧さのためです。
たとえば $\lbrack l, r )$ と表示するには `$[ l, r )$` や `$\[ l, r )$` や `$\\[ l, r )$` ではなく `$\lbrack l, r )$` と書いてください。

## 番号記号 `\#`

番号記号を書くときは `\unicode{35}` を使ってください[^hash]。
Markdown におけるエスケープの記法 `\` の仕様の曖昧さのためです。
たとえば $\unicode{35} A$ と表示するには `$\# A$` や `$\\# A$` ではなく `$\unicode{35} A$` と書いてください。

---

[^underscore]: ただし `_` の前後の文字が共に英数字 (例: `x_i`) なら空白はなしでもよいです。
[^hash]: `\hash` のような命令は、MathJax にはいまのところ存在しないようです。
