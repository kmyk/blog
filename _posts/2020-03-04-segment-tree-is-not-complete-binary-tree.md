---
category: blog
layout: post
date: 2020-03-04T09:00:00+09:00
tags: [ "competitive", "segment-tree" ]
---

# ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã¯å®Œå…¨äºŒåˆ†æœ¨ã«é™å®šã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã¯ãªã„


## ç«¶ãƒ—ãƒ­ç•Œéšˆã§ã¯ã€ã€Œã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã€ã¯å®Œå…¨äºŒåˆ†æœ¨ã«é™ã‚‹ã‚‚ã®ã ã¨ã„ã†ç†è§£ãŒã‚ã‚‹

ç«¶ãƒ—ãƒ­ç•Œéšˆã§ã¯ã€Œã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã€ã¯å®Œå…¨äºŒåˆ†æœ¨[^array]ã¨å¼·ãçµã³ä»˜ã‘ã‚‰ã‚Œã¦ç†è§£ã•ã‚Œã¦ã„ã‚‹ã€‚
ç¾åœ¨ (2020å¹´3æœˆ) Google ã§ã€Œç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã€ãªã©ã¨æ¤œç´¢ã™ã‚‹ã¨ã€Œã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒ„ãƒªãƒ¼ã¯ã€å®Œå…¨äºŒåˆ†æœ¨ã®å½¢ã‚’ã—ã¦ã„ã‚‹ã€ãªã©ã¨ã„ã£ãŸèª¬æ˜ãŒå¤šæ•°è¦‹ã¤ã‹ã‚‹[^tsutaj][^ei1333][^furuya]ã€‚

ã“ã‚Œã¯ [ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚³ãƒ³ãƒ†ã‚¹ãƒˆãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ–ãƒƒã‚¯ ç¬¬2ç‰ˆ](https://www.amazon.co.jp/dp/B00CY9256C) (é€šç§°: èŸ»æœ¬) ã«ç”±æ¥ã™ã‚‹ã‚‚ã®ã ã¨æ€ã‚ã‚Œã‚‹ã€‚èŸ»æœ¬ã¯æ—¥æœ¬ã®ç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ç•Œéšˆã§ã®æ¨™æº–çš„ãªæ•™ç§‘æ›¸ã§ã‚ã‚‹ãŒã€ãã® p153 ã«ã¯ä»¥ä¸‹ã«å¼•ç”¨ã—ãŸã‚ˆã†ã«ã€Œã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã¯å®Œå…¨äºŒåˆ†æœ¨ã‚’ä½¿ã†ã€ã¨æ›¸ã‹ã‚Œã¦ã„ã‚‹ã€‚

>   ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã¯åŒºé–“ã‚’æ‰±ã†ã®ãŒå¾—æ„ãªã€æ¬¡å›³ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚å®Œå…¨äºŒåˆ†æœ¨ï¼ˆã™ã¹ã¦ã®è‘‰ã®æ·±ã•ãŒç­‰ã—ã„äºŒåˆ†æœ¨ã®ã“ã¨ï¼‰ã§ã‚ã‚Šã€å„æ¥ç‚¹ã¯ã€åŒºé–“ã‚’ç®¡ç†ã—ã¾ã™ã€‚â€¦

ã“ã®ã‚ˆã†ãªèª¬æ˜ã«ãªã£ã¦ã„ã‚‹ã®ã¯ã€èŸ»æœ¬ãŒç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®å…¥é–€æ›¸ã ã‹ã‚‰ã ã‚ã†ã€‚
ç«¶æŠ€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«ãŠã„ã¦ã¯æ¼¸è¿‘çš„è¨ˆç®—é‡ã®ã¿ãªã‚‰ãšå®Ÿè£…é‡ã‚„å®šæ•°å€ã‚‚é‡è¦ã§ã‚ã‚‹ã€‚é…åˆ—ä¸Šã®å®Œå…¨äºŒåˆ†æœ¨ã‚’ç”¨ã„ãŸã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã¯ã€ç°¡å˜ã«å®Ÿè£…ã§ãé«˜é€Ÿã«å‹•ä½œã™ã‚‹ãŸã‚ã«å®Ÿç”¨ä¸Šé©åˆ‡ã§ã‚ã‚‹ã€‚
ã¾ãŸã€å…¥é–€æ›¸ã§ã‚ã‚‹ãŸã‚ã«å¹³è¡¡äºŒåˆ†æœ¨ã®èª¬æ˜ãŒçœç•¥ã•ã‚Œã¦ãŠã‚Šã€å®Œå…¨äºŒåˆ†æœ¨ã‚’ç”¨ã„ãŸèª¬æ˜ã—ã‹ã§ããªã‹ã£ãŸã¨ã„ã†äº‹æƒ…ã‚‚ã‚ã‚‹ã ã‚ã†ã€‚å®Ÿéš›ã€å·»æœ«ã®ã€Œæœ¬æ›¸ã§æ‰±ã‚ãªã‹ã£ãŸç™ºå±•çš„ãƒˆãƒ”ãƒƒã‚¯ã€ã®ä¸­ã«ã€Œå¹³è¡¡äºŒåˆ†æ¢ç´¢æœ¨ã€ãŒæŒ™ã’ã‚‰ã‚Œã¦ã„ã‚‹ã€‚


## ã—ã‹ã—ç«¶ãƒ—ãƒ­ç•Œéšˆä»¥å¤–ã§ã¯ã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã¯å¹³è¡¡äºŒåˆ†æœ¨ã‚’ç”¨ã„ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã‚ã‚‹

å­¦è¡“åˆ†é‡ (ã¤ã¾ã‚Šã€ç«¶ãƒ—ãƒ­ç•Œéšˆä»¥å¤–) ã§ã¯ã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã¯å®Œå…¨äºŒåˆ†æœ¨ã«ã¯é™å®šã•ã‚ŒãŸã‚‚ã®ã§ã¯ãªã„ã€‚
ãŸã¨ãˆã°ã€ãŠãã‚‰ãã¯æœ‰åãªå…¥é–€æ›¸[^famous]ã§ã‚ã‚‹ [Computational Geometry: algorithms and applications](https://link.springer.com/book/10.1007/978-3-662-03427-9) ã® $10$ ç«  MORE GEOMETRIC DATA STRUCTURESMORE ã«ãŠã„ã¦ã¯ã€ä»¥ä¸‹ã§å¼•ç”¨ã—ãŸã‚ˆã†ã«ã€Œã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã®éª¨æ ¼ã¯å¹³è¡¡äºŒåˆ†æœ¨ã§ã‚ã‚‹ã€ã¨èª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã€‚å®Œå…¨äºŒåˆ†æœ¨ã«ã¯é™å®šã•ã‚Œã¦ã„ãªã„[^origin]ã€‚

>   The skeleton of the segment tree is a balanced binary tree $\mathcal{T}$. The leaves of $\mathcal{T}$ correspond to the elementary intervals induced by the endpoints of the intervals in I in an ordered way: â€¦


## å¹³è¡¡äºŒåˆ†æœ¨ã‚’ç”¨ã„ãŸã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã§ã¯ã€ã‚ˆã‚Šå¤šãã®ã“ã¨ãŒã§ãã‚‹

åˆ—ã¸ã®è¦ç´ ã®æŒ¿å…¥ã‚¯ã‚¨ãƒªã‚„å‰Šé™¤ã‚¯ã‚¨ãƒªã€åè»¢ã‚¯ã‚¨ãƒªã¨ã‹ãŒã§ãã¾ã™ã€‚æ°¸ç¶šåŒ–ã‚‚ã‚ã‚Šã¾ã™ã€‚èµ¤é»’æœ¨ã¨ã‹ã«ä¹—ã›ã¦é©å½“ã«ã‚„ã£ã¦ãã ã•ã„ (çœç•¥)


## é–¢é€£ãƒ„ã‚¤ãƒ¼ãƒˆ

åˆ†ã‹ã‚Šã‚„ã™ã„å›³:

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">æœ¨ã§åˆ—ã‚’ç®¡ç†ã™ã‚‹ä¸€èˆ¬çš„ãªãƒ†ã‚¯ã§ã™ <a href="https://t.co/oQiE2Xyk6k">pic.twitter.com/oQiE2Xyk6k</a></p>&mdash; ãã‚Œã¡ãƒ¼ (@kuretchi) <a href="https://twitter.com/kuretchi/status/1231816561318457344?ref_src=twsrc%5Etfw">February 24, 2020</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

è«–æ–‡ã«è©³ã—ã„äººã®ç™ºè¨€ (ä¸Šã®å›³ã®ãƒ„ã‚¤ãƒ¼ãƒˆã‚’ãƒªãƒ„ã‚¤ãƒ¼ãƒˆã—ãŸç›´å¾Œã®ãƒ„ã‚¤ãƒ¼ãƒˆ):

<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="ja" dir="ltr">å®Ÿã¯è«–æ–‡ã§ã‚»ã‚°æœ¨ã¨ã„ã†ã¨ã“ã£ã¡ã‚’æŒ‡ã—ã¾ã™ï¼ˆç«¶ãƒ—ãƒ­ã¨è«–æ–‡ã§ç”¨èªãŒãšã‚Œã¦ã‚‹ä¾‹ã®ï¼‘ã¤ï¼‰</p>&mdash; â„¢ ğŸ”° (@tmaehara) <a href="https://twitter.com/tmaehara/status/1232011335669432320?ref_src=twsrc%5Etfw">February 24, 2020</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

---

[^array]: ç‰¹ã«ã€ç‰¹å®šã®é †åºã§æ·»å­—ä»˜ã‘ã¦é…åˆ—ã«æ ¼ç´ã™ã‚‹ã‚‚ã®

[^furuya]:
    >   ã€Œã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒ„ãƒªãƒ¼ã¯ã€å®Œå…¨äºŒåˆ†æœ¨ã®å½¢ã‚’ã—ã¦ã„ã‚‹ã€

    [ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒ„ãƒªãƒ¼å…¥é–€ - ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ´ãªãƒ–ãƒ­ã‚°](https://www.creativ.xyz/segment-tree-entrance-999/)

[^tsutaj]:
    >   ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã¯çš†ã•ã‚“ã”å­˜çŸ¥ã®ã¨ãŠã‚Šã€å›³ã§æ›¸ãã¨ã“ã‚“ãªå½¢ã‚’ã—ã¦ã„ã¾ã™ã€‚â€¦ å…ƒã®ãƒ‡ãƒ¼ã‚¿æ•°ä»¥ä¸Šã«ãªã‚‹æœ€å°ã® 2 å†ªã®æ•°ã‚’ N ã¨ã—ã¾ã™ã€‚ã™ã‚‹ã¨ã€ãƒãƒ¼ãƒ‰ã¯å…¨éƒ¨ã§ 2Nâˆ’1 å€‹ã‚ã‚Šã¾ã™ã€‚

    [ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã‚’ã‚½ãƒ©ã§æ›¸ããŸã„ã‚ãªãŸã« - hogecoder](http://tsutaj.hatenablog.com/entry/2017/03/29/204841)

[^ei1333]:
    >   å®Œå…¨äºŒåˆ†æœ¨ã§ã‚ã‚‹ã€‚ãƒ¢ãƒã‚¤ãƒ‰ã«å¯¾ã™ã‚‹åŒºé–“ã¸ã®æ§˜ã€…ãªæ¼”ç®—ãŒ $O(\log N)$ ã§å®Ÿç¾ã§ãã‚‹ã€‚

    [ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨(Segment-Tree) \| Luzhiledâ€™s memo](https://ei1333.github.io/luzhiled/snippets/structure/segment-tree.html)

[^famous]: ã“ã®åˆ†é‡ã«ã¯è©³ã—ããªã„ã‘ã©ãŸã¶ã‚“ãã†

[^origin]:
    ãªãŠã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ãŒåˆã‚ã¦ç™ºè¦‹ã•ã‚ŒãŸã¨ãã«ã™ã§ã«å¹³è¡¡äºŒåˆ†æœ¨ã‚’ç”¨ã„ã¦ã„ãŸã‹ã«ã¤ã„ã¦ã¯ç¢ºèªã§ããªã‹ã£ãŸã€‚
    ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæœ¨ã¯ Jon Louis Bentley ã«ã‚ˆã£ã¦ "Solutions to Klee's rectangle problems" (1977) ã§åˆã‚ã¦ç™ºè¦‹ã•ã‚ŒãŸãã†ã§ã‚ã‚‹[^discovered]ã€‚
    ã—ã‹ã—ã“ã‚Œã¯ unpublished manuscript ã§ã‚ã‚Šã€å°‘ãªãã¨ã‚‚ web ä¸Šã«ã¯è¦‹ã¤ã‹ã‚‰ãªã„ã€‚

[^discovered]:
    "Computational Geometry: algorithms and applications" ã«æ¬¡ã®ã‚ˆã†ã«ã‚ã‚‹ã€‚
    > The segment tree was discovered by Bentley [33].
